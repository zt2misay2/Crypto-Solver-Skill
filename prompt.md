# CTF å¯†ç å­¦è‡ªåŠ¨æ±‚è§£ SKILL

> ä¸€ä¸ªä¸º Claude Codeã€Codex ç­‰ AI IDE è®¾è®¡çš„å¯†ç å­¦é—®é¢˜æ±‚è§£çŸ¥è¯†åº“

## ğŸ¯ å·¥ä½œæµç¨‹

### Phase 1: ç³»ç»Ÿåˆ†æ

- è¯»å–æ‰€æœ‰å¯†ç å­¦æºä»£ç 
- è¯†åˆ«åŠ å¯†ç®—æ³•ã€å¯†é’¥ç”Ÿæˆã€å‚æ•°
- ç»˜åˆ¶åŠ å¯†æµç¨‹å›¾
- è¾“å‡ºç³»ç»Ÿåˆ†ææŠ¥å‘Š

### Phase 2: æ¼æ´è¯†åˆ«

- åˆ†ææ•°å­¦ç»“æ„å¯»æ‰¾ç†è®ºæ¼æ´
- æ£€æŸ¥å®ç°ç¼ºé™·
- è¯†åˆ«æ”»å‡»é¢
- **PAUSE - ç­‰å¾…ç”¨æˆ·åé¦ˆ**

### Phase 3: æ”»å‡»ç­–ç•¥

- ç»“åˆç”¨æˆ·è¾“å…¥çš„åˆ†æ
- ç»¼åˆç†è®ºä¸å®è·µ
- åˆ¶å®šå…·ä½“æ”»å‡»è®¡åˆ’
- **PAUSE - ç­‰å¾…ç”¨æˆ·ç¡®è®¤**

### Phase 4: ä»£ç å®ç°

- ç”Ÿæˆ Python/SageMath ä»£ç 
- è¿›è¡ŒéªŒè¯æµ‹è¯•
- æ‰§è¡Œæ”»å‡»è·å– Flag

### Phase 5: æ–‡æ¡£ç”Ÿæˆ

- è¾“å‡ºå®Œæ•´ `analyse.md`
- åŒ…å«æ•°å­¦æ¨å¯¼å’Œä»£ç 

---

## ğŸ”’ RSA æ”»å‡»å†³ç­–è¡¨

### ç—‡çŠ¶è¯†åˆ«

| è§‚å¯Ÿåˆ°çš„ç‰¹å¾                  | æ”»å‡»æ–¹æ³•          | å…³é”®å·¥å…·                  |
| ----------------------------- | ----------------- | ------------------------- |
| `e = 3` æˆ– `e` å¾ˆå°ï¼Œå•æ¬¡åŠ å¯† | ä½åŠ å¯†æŒ‡æ•°æ”»å‡»    | `gmpy2.iroot(c, e)`       |
| `e = 3`ï¼ŒåŒä¸€æ¶ˆæ¯åŠ å¯† k æ¬¡    | HÃ¥stad's å¹¿æ’­æ”»å‡» | CRT + `iroot`             |
| å¤šä¸ª `(n, e)` å¯¹ï¼Œå…±äº«å› å­    | å…¬å…±æ¨¡æ•°æ”»å‡»      | `gcd(n1, n2)`             |
| `e` å¼‚å¸¸å¤§ï¼Œ`d` å¯èƒ½å¾ˆå°      | Wiener æ”»å‡»       | è¿åˆ†æ•°å±•å¼€                |
| æ³„æ¼ `d` çš„éƒ¨åˆ†æ¯”ç‰¹ä½         | éƒ¨åˆ†å¯†é’¥æ³„æ¼      | Coppersmith æ–¹æ³•          |
| å·²çŸ¥ `p` çš„é«˜ä½æˆ–ä½ä½         | éƒ¨åˆ†ç´ æ•°æ¢å¤      | `small_roots()`           |
| `p` å’Œ `q` æ¥è¿‘               | Fermat åˆ†è§£       | `isqrt((n + sqrt(n))/2)`  |
| `phi(n)` æ³„æ¼æˆ–éƒ¨åˆ†å·²çŸ¥       | ç›´æ¥åˆ†è§£          | è§£ `n - phi + 1 = p + q`  |
| æä¾›åŠ å¯† Oracle               | é€‰æ‹©å¯†æ–‡æ”»å‡»      | æ„é€  `c' = c * r^e mod n` |
| `n` çš„å› å­æ•° > 2              | é€ä¸ªåˆ†è§£å°å› å­    | Pollard's rho, ECM        |

### å®æ–½æ­¥éª¤

**ä½åŠ å¯†æŒ‡æ•°æ”»å‡» (e=3)**:

```python
from gmpy2 import iroot

# c = m^3 mod n
# å½“ m^3 < n æ—¶ï¼Œm^3 ä¸éœ€è¦ mod
m = int(iroot(c, 3)[0])
```

**Fermat åˆ†è§£**:

```sage
def fermat_factorization(n, max_iter=100000):
    x = isqrt(n)
    x += 1
    y2 = x^2 - n

    for _ in range(max_iter):
        y = isqrt(y2)
        if y^2 == y2:
            p = x - y
            q = x + y
            if p * q == n:
                return (p, q)
        x += 1
        y2 = x^2 - n
    return None
```

**GCD å…¬å…±å› å­åˆ†è§£**:

```python
import math

gcd_result = math.gcd(n1, n2)
if gcd_result > 1:
    p = gcd_result
    q = n1 // p
```

---

## ğŸ” æ¤­åœ†æ›²çº¿ (ECC) æ”»å‡»

### ç—‡çŠ¶è¯†åˆ«

| æ¼æ´ç±»å‹             | æ”»å‡»æ–¹æ³•       | ç‰¹å¾               |
| -------------------- | -------------- | ------------------ |
| æ›²çº¿é˜¶åŒ…å«å°å› å­     | Pohlig-Hellman | é˜¶åˆ†è§£åæœ‰å°ç´ å› å­ |
| å¥‡å¼‚æ›²çº¿             | Smart æ”»å‡»     | `j_invariant` ç‰¹æ®Š |
| Invalid Curve Attack | ç‚¹ä¸åœ¨æ›²çº¿ä¸Š   | è®¡ç®—ä»ç»§ç»­         |
| Twist å®‰å…¨æ€§é—®é¢˜     | Twist æ”»å‡»     | Twist æ›²çº¿é˜¶å¾ˆå°   |

### å®æ–½ä»£ç 

**Pohlig-Hellman ç¦»æ•£å¯¹æ•°**:

```sage
def pohlig_hellman(P, Q, order, factor_dict):
    """
    åˆ©ç”¨å°å› å­å¿«é€Ÿæ±‚ç¦»æ•£å¯¹æ•°

    factor_dict: {ç´ å› å­: ä¸ªæ•°}
    """
    crt_equations = []

    for p, e in factor_dict.items():
        # åœ¨å­ç¾¤ä¸­æ±‚è§£
        p_e = p^e

        P_sub = (order // p_e) * P
        Q_sub = (order // p_e) * Q

        # ç¦»æ•£å¯¹æ•°æ±‚è§£ï¼ˆå°è§„æ¨¡ï¼‰
        for i in range(p_e):
            if i * P_sub == Q_sub:
                crt_equations.append((i, p_e))
                break

    # ä¸­å›½å‰©ä½™å®šç†åˆå¹¶
    return crt(crt_equations)
```

---

## ğŸ§® æ ¼å¯†ç æ”»å‡»

### LWE/NTRU é—®é¢˜

**æ ¼çº¦ç®€ (Lattice Reduction)**:

```sage
# æ„é€ æ ¼
M = Matrix(ZZ, basis)  # basis æ˜¯æ ¼åŸº

# LLL çº¦ç®€
M_reduced = M.LLL()

# BKZ çº¦ç®€ï¼ˆæ›´å¼ºï¼‰
M_reduced = M.BKZ()

# æœ€çŸ­å‘é‡é€šå¸¸å¯¹åº”è§£
shortest_vector = M_reduced[0]
```

### èƒŒåŒ…å¯†ç ç³»ç»Ÿ

**ä½å¯†åº¦æ ¼æ”»å‡»**:

```python
# æ„é€ èƒŒåŒ…é—®é¢˜çš„æ ¼è¡¨ç¤º
# [1  0  0  ... a_1]
# [0  1  0  ... a_2]
# [0  0  1  ... a_3]
# [..............]
# [0  0  0  ... S]

# å…¶ä¸­ S = sum(a_i * x_i)ï¼Œx_i âˆˆ {0,1}

# ä½¿ç”¨ LLL æ±‚æœ€çŸ­å‘é‡
```

---

## ğŸ”‘ æ ¼ (Lattice) å››å¤§é—®é¢˜

1. **SVP (æœ€çŸ­å‘é‡é—®é¢˜)**
   - åœ¨æ ¼ä¸­æ‰¾åˆ°æœ€çŸ­çš„éé›¶å‘é‡
   - NP å›°éš¾

2. **CVP (æœ€è¿‘å‘é‡é—®é¢˜)**
   - ç»™å®šæ ¼å’Œç›®æ ‡ç‚¹ï¼Œæ‰¾æœ€è¿‘çš„æ ¼ç‚¹
   - NP å›°éš¾

3. **SIVP (è¿ç»­æœ€çŸ­å‘é‡é—®é¢˜)**
   - æ‰¾åˆ° n ä¸ªçº¿æ€§ç‹¬ç«‹çš„çŸ­å‘é‡

4. **LWE (æ ¼ä¸Šå­¦ä¹ é—®é¢˜)**
   - ç»™å®š $(a_i, \langle a_i, s \rangle + e_i)$
   - æ¢å¤éšè—ç§˜å¯† $s$

---

## ğŸ¨ å¯¹ç§°åŠ å¯†æ¨¡å¼æ”»å‡»

### ECB æ¨¡å¼

- **æ¼æ´**: ç›¸åŒæ˜æ–‡å— â†’ ç›¸åŒå¯†æ–‡å—
- **æ”»å‡»**: æ¨¡å¼åˆ†æã€å­—å…¸æ”»å‡»
- **æ£€æµ‹**: `ciphertext[0:16] == ciphertext[16:32]`

### CBC æ¯”ç‰¹ç¿»è½¬

- **æ¼æ´**: ä¿®æ”¹ $C_{i-1}$ å½±å“ $P_i$ çš„å¯¹åº”æ¯”ç‰¹
- **åˆ©ç”¨**:
  ```
  m'_i = D(C'_{i-1} âŠ• C_i) = C'_{i-1} âŠ• C_i âŠ• P_i
  ```

### CBC Padding Oracle

- **æ¼æ´**: è¿”å›ä¸åŒçš„é”™è¯¯ä¿¡æ¯é€éœ²å¡«å……æ­£ç¡®æ€§
- **åˆ©ç”¨**: é€å­—èŠ‚æ¢å¤æ˜æ–‡

### CTR/GCM Nonce é‡ç”¨

- **æ¼æ´**: å¯†é’¥æµé‡ç”¨
- **åˆ©ç”¨**:
  ```
  C_1 âŠ• C_2 = M_1 âŠ• M_2
  ```

---

## ğŸ“ é€šç”¨åˆ†ææ¸…å•

ä½¿ç”¨æ­¤æ¸…å•ç¡®ä¿å®Œæ•´åˆ†æï¼š

- [ ] **åŠ å¯†æµç¨‹æ¸…æ™°**: èƒ½ç”»å‡º `[plaintext] â†’ [operations] â†’ [ciphertext]` æµç¨‹
- [ ] **å‚æ•°æ¥æºæ˜ç¡®**: æ‰€æœ‰å…¬å¼€å‚æ•°ç”Ÿæˆæ–¹å¼ç†è§£
- [ ] **æ•°æ®æ ¼å¼ç¡®è®¤**: å¯†æ–‡æ˜¯å­—èŠ‚ä¸²ã€æ•´æ•°ã€è¿˜æ˜¯å…¶ä»–
- [ ] **Oracle/çº¦æŸ**: æ¸…æ¥šæ‰€æœ‰è¾“å…¥è¾“å‡ºå’Œé™åˆ¶
- [ ] **ç‰¹æ®Šæ¡ä»¶**: "åªèƒ½è¯¢é—® 100 æ¬¡" ç­‰éšå¼çº¦æŸ

---

## ğŸ›  SageMath å¿…éœ€åº“

### åŸºç¡€å¯¼å…¥

```sage
# æ•´æ•°åˆ†è§£å’Œç´ æ€§æµ‹è¯•
from sage.all import *
from sage.misc.all import *

# æ ¼è®ºåº”ç”¨
from sage.matrix.all import *
from sage.rings.finite_rings.finite_field_constructor import FiniteField as GF

# æ•°è®º
from sympy import factorint, divisors
```

### å…³é”®å‡½æ•°

| æ“ä½œ             | ä»£ç                                    |
| ---------------- | -------------------------------------- |
| è´¨å› æ•°åˆ†è§£       | `factor(n)` æˆ– `factorint(n)`          |
| ç¦»æ•£å¯¹æ•°         | `discrete_log(Q, P)`                   |
| æœ€çŸ­å‘é‡         | `Matrix(basis).LLL()[0]`               |
| æ¨¡é€†             | `pow(a, -1, n)` æˆ– `inverse_mod(a, n)` |
| ä¸­å›½å‰©ä½™å®šç†     | `crt_list([a1,a2,...], [m1,m2,...])`   |
| å¹³æ–¹æ ¹           | `sqrt(x)` æˆ– `tonelli_shanks(a, p)`    |
| æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•° | `E.discrete_log(Q, P)`                 |

---

## ğŸš€ æ‰§è¡ŒæŒ‡ä»¤

### Claude Code ä¸­ä½¿ç”¨

**åˆ†æç³»ç»Ÿ**:

```
/skill analyze-crypto secret.py
```

**ç”Ÿæˆæ”»å‡»**:

```
/skill generate-attack "common-modulus"
/skill generate-attack "low-exponent"
/skill generate-attack "wiener-attack"
```

**æ‰§è¡Œ SageMath**:

```
/skill run-sage
# è¾“å…¥æˆ–ç²˜è´´ SageMath ä»£ç 
# æŒ‰ Ctrl+D æ‰§è¡Œ
```

**ä¸€é”®æ±‚è§£**:

```
/skill solve-challenge challenge.py output.txt
```

---

## ğŸ“Š è¾“å‡ºæ ‡å‡†

### analyse.md ç»“æ„

```markdown
# [é¢˜ç›®åç§°] é¢˜è§£åˆ†æ

## A. é—®é¢˜ç»“æ„

### åŠ å¯†ç³»ç»Ÿæ„é€ 

...

### Flag åŠ å¯†è¿‡ç¨‹

...

### ç»™å®šæ¡ä»¶

...

---

## B. æ±‚è§£æ€è·¯

### æ ¸å¿ƒæ¼æ´

$$
\text{æ•°å­¦å…¬å¼}
$$

### æ”»å‡»è·¯å¾„

1. **æ­¥éª¤ 1**: ...
   $$
   \text{æ¨å¯¼å…¬å¼}
   $$

---

## C. è§£é¢˜ä»£ç 

### å®Œæ•´ Exploit

\`\`\`python

# exploit.py

... ä»£ç  ...
\`\`\`

**æ‰§è¡Œæ–¹å¼**:
\`\`\`bash
python exploit.py
\`\`\`

**ç»“æœ**:
\`\`\`
Flag: flag{...}
\`\`\`

---

## D. æ€»ç»“åæ€

...
```

---

## â± æ—¶é—´çº¦æŸ

- **å¿«é€Ÿæµ‹è¯• (< 5min)**: ç›´æ¥æ‰§è¡Œ
- **é•¿æ—¶é—´è®¡ç®— (> 5min)**:
  1. ä¼°è®¡è¿è¡Œæ—¶é—´
  2. é€šçŸ¥ç”¨æˆ·
  3. ç­‰å¾…ç”¨æˆ·æ‰¹å‡†
  4. æ˜¾ç¤ºè¿›åº¦

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜: "æ¨¡å—ä¸å­˜åœ¨"

**è§£å†³**:

```bash
# WSL ä¸­å®‰è£…
wsl sudo apt install python3-pip
wsl pip3 install gmpy2 sympy pwntools
wsl python3 -c "import gmpy2; print('OK')"
```

### é—®é¢˜: "Sage å‘½ä»¤æœªæ‰¾åˆ°"

**è§£å†³**:

```bash
# WSL ä¸­éªŒè¯ sage
wsl which sage
wsl sage --version

# æˆ–æŒ‡å®šå®Œæ•´è·¯å¾„
wsl /usr/bin/sage
```

### é—®é¢˜: "è¶…æ—¶é”™è¯¯"

**è§£å†³**:

- å‡å°‘è¿­ä»£æ¬¡æ•°
- ä½¿ç”¨æ›´å¿«çš„ç®—æ³•
- æˆ–å¢åŠ è¶…æ—¶æ—¶é—´

---

## ğŸ“š å‚è€ƒèµ„æº

### æ•™ç§‘ä¹¦

- Handbook of Elliptic and Hyperelliptic Curve Cryptography
- Understanding Cryptography by Paar & Pelzl
- A Course in Number Theory and Cryptography by Koblitz

### å·¥å…·

- SageMath: https://www.sagemath.org/
- pwntools: https://docs.pwntools.com/
- gmpy2: https://gmpy2.readthedocs.io/

### CTF å‚è€ƒ

- Cryptohack: https://cryptohack.org/
- FactorDB: http://factordb.com/
- RC Decrypt: https://www.rc-decrypt.com/

---

## âœ… æ£€æŸ¥æ¸…å• (æ±‚è§£å‰å¿…è¯»)

åœ¨å¼€å§‹æ±‚è§£å‰ï¼Œç¡®ä¿æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- [ ] è¯»å–æ‰€æœ‰å¯†ç å­¦æºä»£ç 
- [ ] ç†è§£åŠ å¯†ç®—æ³•å’Œå‚æ•°
- [ ] ç»˜åˆ¶åŠ å¯†æµç¨‹å›¾
- [ ] è¯†åˆ«å‡ºè‡³å°‘ä¸€ä¸ªå¯åˆ©ç”¨çš„æ¼æ´
- [ ] æœ‰å…·ä½“çš„æ”»å‡»è®¡åˆ’
- [ ] æ‰€æœ‰ SageMath ä¾èµ–å·²å®‰è£…
- [ ] å‡†å¤‡å¥½å¤„ç†è¶…è¿‡ 5 åˆ†é’Ÿçš„è®¡ç®—
- [ ] èƒ½å¤Ÿè§£é‡Šæ‰€æœ‰æ•°å­¦æ­¥éª¤

---

**ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2026-02-06  
**ç»´æŠ¤è€…**: Crypto-Solver-Team
